<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BPFAM â€” Video Ufficiali</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="wrap">
    <h1 class="brand">ðŸŽ¬ BPFAM â€” <span>Video Ufficiali</span> ðŸ’Ž</h1>

    <!-- Griglia automatica -->
    <section id="grid" class="grid"></section>

    <footer class="foot">Â© 2025 â€” BPFAM Official Network ðŸ’Ž</footer>
  </main>

  <script>
    // ðŸ”§ CONFIG â€” se il nome repo/utente cambia, modifica qui
    const OWNER = "bpfam";
    const REPO  = "Video-bpfam";      // esatto come su GitHub
    const FOLDER = "video";            // cartella che contiene gli .mp4

    // API GitHub: lista file nella cartella /video della branch main
    const API = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${FOLDER}?ref=main`;

    // Helper: crea card singola
    function cardFor(file){
      const name = (file.name || "").replace(/\.[^/.]+$/,""); // senza estensione
      const src  = `./${FOLDER}/${file.name}`;                 // path diretto al file
      const el = document.createElement("article");
      el.className = "tile";
      el.innerHTML = `
        <div class="thumb">
          <video preload="metadata" controls playsinline>
            <source src="${src}" type="video/mp4" />
          </video>
        </div>
        <div class="caption" title="${name}">${name}</div>
      `;
      return el;
    }

    async function load(){
      try{
        const res = await fetch(API, { headers: { "Accept":"application/vnd.github+json" }});
        const list = await res.json();
        const mp4s = (Array.isArray(list) ? list : []).filter(f => /\.mp4$/i.test(f.name));
        const grid = document.getElementById("grid");
        if(!mp4s.length){
          grid.innerHTML = `<p class="empty">Nessun video trovato nella cartella <code>/${FOLDER}</code>.</p>`;
          return;
        }
        mp4s.sort((a,b)=> a.name.localeCompare(b.name, 'it', {numeric:true}));
        mp4s.forEach(f => grid.appendChild(cardFor(f)));
      }catch(e){
        document.getElementById("grid").innerHTML =
          `<p class="empty">Impossibile caricare i video. Riprova tra poco.</p>`;
        console.error(e);
      }
    }
    load();
  </script>
</body>
</html>